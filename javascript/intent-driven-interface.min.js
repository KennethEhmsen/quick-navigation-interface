!function(a){"use strict";var b=window.IntentDrivenInterface={Models:{},Collections:{},Views:{},start:function(){try{b.options=idiOptions,b.mainContainer=a("#idi-container"),b.searchField=a("#idi-search-field"),b.searchResults=a("#idi-search-results"),b.instructions=a("#idi-instructions"),idiOptions=null,b.allLinks=new b.Collections.Links(b.getAllLinks()),b.activeLinks=new b.Collections.Links([]),b.searchResultsView=new b.Views.Links({el:b.searchResults,collection:b.activeLinks}),a(window).keyup(b.toggleInterface),b.mainContainer.click(b.toggleInterface),b.searchField.keyup(b.showRelevantLinks)}catch(c){b.log(c)}},getAllLinks:function(){var c=[];return a("a").each(function(){c.push(new b.Models.Link({title:a(this).text(),url:a(this).attr("href")}))}),c},toggleInterface:function(a){try{if("keyup"===a.type)if(a.which===b.options.shortcuts["open-interface"].code){if("input"===a.target.tagName.toLowerCase()||"textarea"===a.target.tagName.toLowerCase())return;b.searchField.val(""),b.mainContainer.addClass("idi-active"),b.searchField.focus()}else a.which===b.options.shortcuts["close-interface"].code&&(b.mainContainer.removeClass("idi-active"),b.instructions.removeClass("idi-active"),b.activeLinks.reset());else"click"===a.type&&("notification-dialog-background"===a.target.className||"media-modal-icon"===a.target.className)&&b.mainContainer.removeClass("idi-active")}catch(c){b.log(c)}},showRelevantLinks:function(a){var c,d;try{a.which===b.options.shortcuts["open-link"].code?(c=b.searchResults.find("li.idi-active").find("a"),void 0!==c.attr("href")&&c.get(0).click()):a.which===b.options.shortcuts["next-link"].code?b.activeLinks.moveActiveLink("forwards"):a.which===b.options.shortcuts["previous-link"].code?b.activeLinks.moveActiveLink("backwards"):(d=b.searchField.val(),""===d?(b.instructions.removeClass("idi-active"),b.searchResults.removeClass("idi-active")):(b.instructions.addClass("idi-active"),b.searchResults.addClass("idi-active")),b.allLinks.invoke("set",{state:"inactive"}),b.activeLinks.reset(b.allLinks.search(d,b.options.limit)))}catch(e){b.log(e)}},log:function(a){window.console&&("string"==typeof a?console.log("Intent-Driven Interface: "+a):console.log("Intent-Driven Interface: ",a))}}}(jQuery),function(){"use strict";var a=window.IntentDrivenInterface;a.Collections.Links=Backbone.Collection.extend({model:a.Models.Link,search:function(a,b){var c=[];return""!==a&&this.every(function(d){return d.get("title").toLowerCase().indexOf(a.toLowerCase())>=0&&c.push(d),c.length<b}),c.hasOwnProperty(0)&&c[0].set({state:"active"}),c},moveActiveLink:function(a){var b,c=this.where({state:"active"}),d=this.indexOf(c[0]);"forwards"===a?(b=d+1,this.length===b&&(b=0)):(b=d-1,-1===b&&(b=this.length-1)),this.at(d).set({state:"inactive"}),this.at(b).set({state:"active"})}})}(),function(){"use strict";var a=window.IntentDrivenInterface;a.Models.Link=Backbone.Model.extend({defaults:{title:"",url:"",state:"inactive"}})}(),function(){"use strict";var a=window.IntentDrivenInterface;a.Views.Link=Backbone.View.extend({tagName:"li",template:wp.template("intent-link"),initialize:function(){this.render(),this.listenTo(this.model,"change",this.render)},render:function(){"active"===this.model.get("state")?this.$el.addClass("idi-active"):this.$el.removeClass("idi-active"),this.$el.html(this.template(this.model.toJSON()))}}),a.Views.Links=Backbone.View.extend({tagName:"ul",initialize:function(){this.render(),this.listenTo(this.collection,"reset",this.render)},render:function(){this.$el.html(""),this.collection.each(function(b){var c=new a.Views.Link({model:b});this.$el.append(c.el)},this)}})}(),IntentDrivenInterface.start();
//# sourceMappingURL=intent-driven-interface.min.js.map